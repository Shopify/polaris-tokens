# Contributing

When contributing to this repository, please first discuss the change you wish to make via an issue with the owners of this repository before making a change. Adding tests, documentation updates such as typo fixes and other improvements are welcome at any time without submitting an issue first.

Please note we have a [code of conduct](https://github.com/Shopify/polaris-tokens/blob/master/.github/CODE_OF_CONDUCT.md), please follow it in all your interactions with the project.

---

## Generating the design tokens

In a terminal, paste the following instructions.

With `dev` (Shopify employees):

```
dev clone polaris-tokens
dev up
dev start
```

Without `dev` (external contributors), with [yarn](https://yarnpkg.com/en/):

```
git clone https://github.com/Shopify/polaris-tokens.git
cd polaris-tokens
yarn
yarn dist
```

Tokens are exported under the `dist/` folder for consumption by external projects:

```
color-filters.color-map.scss
color-filters.common.js
color-filters.custom-properties.css
color-filters.json
color-filters.map.scss
color-filters.raw.json
color-filters.scss
colors.android.xml
colors.ase.json
colors.color-map.scss
colors.common.js
colors.custom-properties.css
colors.json
colors.map.scss
colors.raw.json
colors.scss
duration.common.js
duration.custom-properties.css
duration.json
duration.map.scss
duration.raw.json
duration.scss
index.common.js
index.custom-properties.css
index.d.ts
index.json
index.map.scss
index.raw.json
index.scss
Polaris.ase
Polaris.clr
Polaris.sketchpalette
spacing.common.js
spacing.custom-properties.css
spacing.json
spacing.map.scss
spacing.raw.json
spacing.scss
spacing.spacing-map.scss
typography.common.js
typography.custom-properties.css
typography.json
typography.map.scss
typography.raw.json
typography.scss
```

---

## Developing with the watch mode

In watch mode, the [documentation](https://shopify.github.io/polaris-tokens/) automatically live reloads at <http://localhost:3000>
when design tokens files (`./tokens/*.yml`) are edited.

```
dev server
```

or, if you don‚Äôt have `dev` on your machine:

```
yarn watch
```

---

## Running the tests

This project uses [Jest snapshot testing](https://facebook.github.io/jest/docs/en/snapshot-testing.html) to test the output of design tokens files in `./dist` generated from the YAML source files from `./tokens`.

Tests are located in the [`__tests__`](https://github.com/Shopify/polaris-tokens/tree/master/__tests__) folder.

### Running tests once

```
yarn test
```

### Running tests on every file change

When developing or refactoring, running tests continuously can be a great time saver.

This command will run the test suite every time a file change is detected:

```
yarn test-watch
```

### Updating snapshots

Snapshots can become out of date (for example, after an update was made to any of the `./tokens/*.yml` files), and need to be updated for the test to pass:

```
yarn test -u
```

---

## Editing design tokens

Design tokens source files are in the `./tokens` directory, in YAML format.

Adding, removing, and updating design tokens should be discussed in the issues of this project before contributing to code changes.

Note: `./tokens/colors.yml` should not be manually edited, as it is automatically generated by this project.
Colors are managed in [Invision Design System Manager](https://www.invisionapp.com/blog/announcing-invision-design-system-manager/) (see below).

---

## Updating color tokens

Color names, values and descriptions are managed in [Invision Design System Manager](https://www.invisionapp.com/blog/announcing-invision-design-system-manager/) at this URL:
<https://shopify.invisionapp.com/dsm/shopify/design-tokens>.

### Adding colors

1.  Install the Craft Plugin in [Sketch](https://www.sketchapp.com/) and log in with your Shopify account.
2.  Once Craft for Sketch is set up, open Design System Manager, and follow these steps:

    ![ ](https://user-images.githubusercontent.com/85783/38760431-0e55954e-3f30-11e8-935c-7ba35b0edc44.png)

    ![ ](https://user-images.githubusercontent.com/85783/38760487-60970130-3f30-11e8-8a45-e02b7c8c4b46.png)

3.  Finally, **[open a new issue][issue-temlpate-color-updated]**

### Changing a color‚Äôs name

Color names are editable in <https://shopify.invisionapp.com/dsm/shopify/design-tokens> or via the Sketch Craft plugin, under the Design System Manager tab.

Important considerations before changing color names: this type of update is a breaking change,
and products consuming design tokens will have to update all occurrences of the old name in their codebases.

1.  Change the name of the color
2.  **[Open a new issue][issue-template-color-updated]**

### Editing a color‚Äôs value

At the time these lines were written, Invision Design System Manager doesn‚Äôt support editing colors.

Here‚Äôs a workaround:

1.  Delete said color
2.  Re-add the color (with the same name), this time specifying the new value
    (following the steps described above in ‚ÄúAdding colors‚Äù)
3.  **[Open a new issue][issue-template-color-updated]**

When updating a color, please also remember to update its `filter` metadata. Filter values can be generated using [this CodePen](https://codepen.io/kaelig/full/jeObGP/) and are stored in [`/data/color-metadata.yml`](https://github.com/Shopify/polaris-tokens/blob/master/data/color-metadata.yml).

### Developers

This script fetches color data from the DSM API and dumps it in [`tokens/colors.yml`](https://github.com/Shopify/polaris-tokens/blob/master/tokens/colors.yml) under a format appropriate for consumption by [Theo](https://github.com/salesforce-ux/theo):

```
yarn get-tokens-from-invision-dsm
yarn dist
yarn test -u
```

[issue-template-color-updated]: https://github.com/Shopify/polaris-tokens/issues/new?template=update-colors.md&title=Update%20colors%20üé®

## Releasing

When releasing a new version, follow these steps on `master`:

1.  Update [CHANGELOG.md](https://github.com/Shopify/polaris-tokens/blob/master/CHANGELOG.md) and commit the changes
2.  Run `yarn version` and assign a new version
3.  Run `git push --follow-tags`
4.  [Deploy on Shipit](https://shipit.shopify.io/shopify/polaris-tokens/production)
